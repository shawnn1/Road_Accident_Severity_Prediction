<!doctype html
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
 
    <link rel="stylesheet" href="https://bootswatch.com/4/flatly/bootstrap.min.css">
	
    <link rel="stylesheet" type="text/css" href="/static/index.css">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
    <title>App!</title>
<div class="header">
  <a href="#default" class="logo">GOOGOLML</a>
  <div class="header-right">
    <a href="/Home">Home</a>
    <a href="/map">Map</a>
    <a href="/visual">Visualization</a>
  </div>
</div>


<div style="background-color: green;" class="container">
	<div>
		<h1 class="jumbotron" style="padding: 1% ; text-align: center;" >Road Accident Prediction and Classification </h1>
	</div>
	<div class="row">
		<div class="col-8">
	      	<div class="form-group">
				     <label style="color:white" for="Location">Latitude and Longitude</label>
			          <div class="row">
			               <div class="col-6">
			                  <input type="text" class="form-control" name="lat" value="55" id="lat">
				           </div>
				           <div class="col-6">
			                    <input type="text" class="form-control" name="lon" value="-121" id="lon">
				           </div>
			         </div>
			    <br>
			    <center>
			    	<button style="color: black;" id = "getIt" onclick = "getLocation() ">Send Cordinates to Update Conditions</button>
			    </center>

			             <div style="width: 400;" class="form-group">
                            <label style="color: white;" for="Day_of_Week">Day of week</label>
							<select style="color: black;" class="form-control" id="day">
							<option value="3">1 : Sunday</option>
							 <option value="1">2 : Monday</option>
							 <option value="5">3 : Tuesday</option>
							 <option value="6">4 : Wednesday</option>
							 <option value="4">5 : Thursday</option>
							 <option value="0">6 : Friday</option>
							 <option value="1">7 : Saturday</option>
						   </select>
                        </div>
			       
			    
			</div>
			<div style="width: 400;" class="form-group">
			    <label style="color: white;" for="gender">Gender</label>
			    <select style="color: black;" class="form-control" name="Road_Surface_Conditions" id="gender">
		       		<option value="1">1 : Male</option>
			        <option value="2">2 : Female</option>
			        <option value="3">3 : Unknown</option>
			    </select>
			   <!--  <input type="text" class="form-control" name="gender" value="1" id="gender"> -->
			</div>
	      
	      	<div style="width: 400;" class="form-group">
			    <label style="color: white;" for="Age_of_Driver">Age of Driver</label>
			    <input style="color:black" type="text" class="form-control" name="Age_of_Driver" value="34" id="age_of_driver">
			</div>

	      	<div style="width: 400;" class="form-group">
			    <label style="color: white;" for="Type_of_collision">Type of Collision</label>
			        <select style="color:black" class="form-control" id="Type_of_collision" name="Type_of_collision">
		       		<option value="1">1 : Collision with pedestrians</option>
			        <option value="8">2 : Vehicle with vehicle collision</option>
			        <option value="3">3 : Collision with roadside-parked vehicles</option>
			        <option value="2">4 : Collision with roadside objects</option>
			        <option value="0">5 : Collision with animals</option>
			        <option value="9">8 : With Train</option>
			        <option value="4">9 : Fall from vehicles</option>
			        <option value="5">10 : Other</option>
			       		        
			      </select>

			    <!-- <input type="text" class="form-control" name="Vehicle_Type" value="11" id="vehicle_type"> -->
			</div>

			

	      	


	      	<div style="width: 400;" class="form-group">
			    <label style="color: white;" for="Weather_conditions">Weather Conditions</label>
			        <select style="color:black" class="form-control" id="weather" name="Weather_conditions">
		       		<option value="2">1 : Normal</option>
			        <option value="4">2 : Raining</option>
			        <option value="5">3 : Raining and Windy</option>
			        <option value="0">4 : Cloudy</option>
			        <option value="8">5 : Windy</option>
			        <option value="6">6 : Snow</option>
			        <option value="1">7 : Fog or mist</option>
					<option value="3">8 : Other</option>
			      </select>
			   <!--  <input type="text" class="form-control" name="Weather_Conditions" value="1" id="weather"> -->
			</div>

	      	<div style="width: 400;" class="form-group">
			    <label style="color: white;" for="Light_Conditions">Light_Conditions</label>
			    <select style="color:black" class="form-control" name="Light_Conditions" id="light" >
		       		<option value="3">1 : Daylight</option>
			        <option value="0">2 : Darkness - lights lit</option>
			        <option value="1">3 : Darkness - lights unlit</option>
			        <option value="2">4 : Darkness - no lighting</option>
			      </select>
			    <!-- <input type="text" class="form-control" name="Light_Conditions" value="1" id="light" > -->
			</div>
	      	<div style="width: 400;" class="form-group">
			    <label style="color:white;" for="Road_Surface_Conditions">Road Surface Conditions</label>

			    <select style="color: black;" class="form-control" name="Road_Surface_Conditions" id="roadsc">
		       		<option value="1">1 : Dry</option>
			        <option value="2">2 : Wet or damp</option>
			        <option value="3">3 : Snow</option>
			        <option value="4">4 : Frost or Ice</option>
			        <option value="5">5 : Flood</option>
			        <option value="7">7 : Mud</option>
			    </select>
			    <!-- <input type="text" class="form-control" name="Road_Surface_Conditions" value="1" id="roadsc">
 -->			</div>
             <div style="width: 400;" class="form-group">
				<label style="color: white;" for="Number_of_vehicles_involved" >Number_of_vehicles_involved</label>
				<input style="color: black;" type="text" class="form-control" name="Number_of_vehicles_involved" value="2" id="Number_of_vehicles_involved">

			 </div>
			 <div style="width: 400;" class="form-group">
				<label style=" color: white;" for="Number_of_casualties" >Number_of_casualties</label>
				<input style="color: black;" type="text" class="form-control" name="Number_of_casualties" value="2" id="Number_of_casualties">

			 </div>
			 <div class="form-group">
			    <label style="color: white" for="Vehicle_movement">Vehicle_movement</label>

			    <select style="color: black;" class="form-control" name="Vehicle_movement" id="Vehicle_movement">
		       		<option value="2">1 : Going straight</option>
			        <option value="3">2 : Moving Backward</option>
			        <option value="5">3 : Overtaking</option>
			        <option value="7">4 : Reversing</option>
			        <option value="4">5 : Other</option>
			        
			    </select>
			    <!-- <input type="text" class="form-control" name="Road_Surface_Conditions" value="1" id="roadsc">
 -->			</div>


	      	

			<button style="background-color: greenyellow; color:black" type="button" class="btn btn-success btn-block" id="submitBtn">Predict</button>
	<button style="background-color: darkred; color: black;" type="button" class="btn btn-info btn-block" id="smsbutton">sms</button>
		</div>
		<div class="col-4 jumbotron text-center" style="position: fixed; width: 300; height:300 ;right: 0">
			<strong>Accident Severity Table <br></strong>
			<div style="background-color: green;" class="alert alert-warning">
			  	0 = Fatal<br>
				1 = SERIOUS<br>
				2 = SLIGHT <br>
			</div>
		    <h6 style="text-align: center;"> OUTPUT PREDICTED : </h6>
		    <div style="font-size:300%;text-align:center;" id="result"></div>
			<hr>
		</div>
	</div>
  
	
</div>

	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <script>


function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(showPosition);
  } else { 
    x.innerHTML = "Geolocation is not supported by this browser.";
  }


function showPosition(position) {
	    var i=position.coords.latitude;
    	var j=position.coords.longitude;
    	document.getElementById("lat").value=i;
    	document.getElementById("lon").value=j;
    	

        $.ajax({url: "https://api.openweathermap.org/data/2.5/weather?lat="+i+"&lon="+j+"&APPID=dc0d323b4933f0c038f261425b17038e",
        	success: function(res){
        		if(res.weather[0].main === "mist")
        		document.getElementById("weather").value=1;
        		else if(res.weather[0].main === "clear")
        		{
        			document.getElementById("weather").value=2;
        			document.getElementById("roadsc").value=1;
        		}
        		else if(res.weather[0].main === "Rain")
        			{
        				document.getElementById("weather").value=4;
        				document.getElementById("roadsc").value=2;
        			}
        		else if(res.weather[0].main === "Snow")
        		{
        			document.getElementById("weather").value=6;
        			document.getElementById("roadsc").value=3;
        		}
        		else if(res.weather[0].main === "Clouds")
        		{
        			document.getElementById("weather").value=2;
        			document.getElementById("roadsc").value=1;
        		}
        		
        		  var d = new Date();
  				  var n = d.getHours();
				  
  				  if(n>=18 || n<=6)
        		  document.getElementById("light").value=1;
        		  else if(n>6 || n<18)
        		  	document.getElementById("light").value=3;
                  wekday=[3,1,5,6,4,0,1]
        		  var d = d.getDay();
        		  document.getElementById("day").value=wekday[d];

        }});
    }
    }

	    document.addEventListener('DOMContentLoaded', function() {
	        document.getElementById('submitBtn').addEventListener('click', function(e) {
	            e.preventDefault();
	            $('#result').html('Loading...');
			console.log($('#Number_of_casualties').val());

	            $.post(
	                '/',
	                {
	                    day: $('#day').val()[0],
                        Type_of_collision:$('#Type_of_collision').val()[0],
                        Number_of_vehicles_involved:$('#Number_of_vehicles_involved').val()[0],
                        Number_of_casualties:$('#Number_of_casualties').val()[0],
	                    Vehicle_movement:$('#Vehicle_movement').val()[0],
	                    weather: $('#weather').val()[0],
	                    light: $('#light').val()[0],
	                   
	                },
	                function(data) {
	                    $('#result').html(data);
	                    console.log(data);
	                }
	            );
	        });

		     document.getElementById('smsbutton').addEventListener('click', function(e) {
                    e.preventDefault();
                    $('#result').html('Loading...');
                        console.log($('#gender').val());

                    $.post(
                        '/sms/',
                        {
						day: $('#day').val()[0],
                        Type_of_collision:$('#Type_of_collision').val()[0],
                        Number_of_vehicles_involved:$('#Number_of_vehicles_involved').val()[0],
                        Number_of_casualties:$('#Number_of_casualties').val()[0],
	                    Vehicle_movement:$('#Vehicle_movement').val()[0],
	                    weather: $('#weather').val()[0],
	                    light: $('#light').val()[0],
	                   
	                   
                        },
                        function(data) {
                            $('#result').html(data);
                            console.log(data);
                        }
                    );
                });
		    
	    });
	</script>
  </body>
  
</html>

  <!-- <script> -->
<!-- // function validate() {
//     var x = document.forms["myform"]["user"].value;
//     if (x == "") {
//         alert("Name must be filled out");
//         return false;
//     }
// } -->
<!-- </script> -->